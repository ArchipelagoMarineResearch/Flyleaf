<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>net5.0-windows;net472</TargetFrameworks>
	<UseWindowsForms>true</UseWindowsForms>
	<UseWPF>true</UseWPF>
	<PackageIcon>Flyleaf.png</PackageIcon>
	<PackageIconUrl />
	<RepositoryUrl></RepositoryUrl>
	<Description>Media Player .NET Library for WPF/WinForms (based on FFmpeg/DirectX)</Description>
	<Version>3.4.0-pre2</Version>
	<Authors>SuRGeoNix</Authors>
	<Copyright>SuRGeoNix Â© 2021</Copyright>
	<PackageLicenseExpression>LGPL-3.0-or-later</PackageLicenseExpression>
	<PackageProjectUrl>https://github.com/SuRGeoNix/Flyleaf</PackageProjectUrl>
	<PackageTags>flyleaf flyleaflib video audio media player engine framework download extract ffmpeg vortice directx</PackageTags>
	<IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>
    <PackageReleaseNotes>
		-= Extends Media Player's Functionality (Adds WinForms Support) =-

		1) Key Bindings (Config.Player.KeyBindings.Enabled - ON By Default)
		Allows to Add/Remove any (Ctrl +) Key combination and assign an existing action or even a custom (can also be loaded/saved with config)
		Uses by default all common bindings
		(Pause/Play/Open/Seek Backward-Forward/FullScreen/Record/TakeSnapshot/Speed Up-Down/Delays/Prev-Next Frame/Pan Zoom In-Out-Reset/Toggle AVS On-Off/Volume Up-Down-Mute)

		2) Mouse Bindings (Config.Player.MouseBindigns.Enabled - ON By Default)
		OpenOnDragAndDrop (Drag &amp; Drop), PanMoveOnDragAndCtrl (Pan Move), PanZoomOnWheelAndCtrl (Pan Zomm In/Out), ToggleFullScreenOnDoubleClick (Toggle FullScreen)

		3) Activity Mode (Config.Player.ActivityMode) | Master Thread required
		Monitors user's actions based on Key/Mouse events and updates the mode to Idle / Active(keyboard only) / FullActive(mouse) based on Config.Player.ActivityTimeout
		Exposes Player.Activity.ForceIdle / ForceActive / ForceFullActive for custom updates

		4) Extends frequently used (Helper) methods for direct calls, Key Bindings assignments or ICommands usage (Player / Player.Audio / Player.Video / Player.Subtitles / Player.Commands)

		5) Master Thread (Master.UIRefresh, UIRefreshInterval, UICurTimePerSecond)
		Will monitor and refresh all players on single UI Invoke (CurTime if not per second/BufferedDuration on pause/BitRate Stats etc.)
		Allows updates even when the players/demuxers are not running
		Allows more frequent update for CurTime (Master.UICurTimePerSecond = false) rather than on exact second change on timestamps

		6) Additional Config.Player offsets added (for key/mouse bindings)
		AudioDelayOffset, AudioDelayOffset2, SubtitlesDelayOffset, SubtitlesDelayOffset2
		SeekOffset, SeekOffset2, VolumeOffset, ZoomOffset

		7) Auto Play (Config.Player.AutoPlay - ON By Default)
		Not required to subscribe on open completed events to start playing

		8) Adds HLS Live cache support amp; uses accurate timestamps

		9) Adds BufferingStarted / BufferingCompleted (with error support) events and success/fail to PlaybackCompleted

		10) Default Directories and Filenames for TakeSnapshot (allows also more formats) and StartRecording if filenames are not specified
		Config.Player.FolderSnapshots, Config.Player.SnapshotFormat, Config.Player.FolderRecordings

		10) Updates (FFmpeg.AutoGen / Vortice)

		[Issues]

		1) Fixes a read timeout issue with live streams (while demuxing at the end of stream and waiting for new packets)
		2) Fixes a dead lock with Audio Decoder during multiple ReSyncs
		3) Fixes critical issues during swaping players new feature
		3) Fixes ShowFrameNext/ShowFramePrev issues and improvements
		4) Controls.WPF: Fixes an issues with comma/dot string to double convert issue based on system culture

		[Breaking / Important Changes]

		1) Config.Demuxer.FormatOpt["probesize"] amp; Config.Demuxer.FormatOpt["analyzeduration"] have been added by default which can cause an already exists exception
		2) Config.Demuxer.BufferDuration changed from 5 minutes to 2 (to reduce RAM)
		3) Config.Player.MinBufferDuration change from 1000ms to 500ms
		4) Config.Decoder.MaxVideoFrames changed from Math.Max(10, Environment.ProcessorCount) to 4 (to reduce VRAM)
		5) Config.Player.Speed amp; Config.Player.SpeedReverse moved to single Player.Speed (valid values 0.0 - 1.0 and 1,2,3,4)
		6) VideoView.IsFullScreen / FullScreen / NormalScreen moved to Player and support also WinForms now
		7) Check more changes and renames on Controls.WPF -&gt; Flyleaf.xaml
	</PackageReleaseNotes>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <DocumentationFile>FlyleafLib.xml</DocumentationFile>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>

  <ItemGroup>
    <None Remove="MediaFramework\MediaRenderer\Shaders\FlyleafPS.hlsl" />
    <None Remove="MediaFramework\MediaRenderer\Shaders\FlyleafVS.hlsl" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Include="MediaFramework\MediaRenderer\Shaders\FlyleafPS.hlsl" />
    <EmbeddedResource Include="MediaFramework\MediaRenderer\Shaders\FlyleafVS.hlsl" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="FFmpeg.AutoGen" Version="4.4.1.1" />
    <PackageReference Include="NAudio.Core" Version="2.0.0" />
    <PackageReference Include="NAudio.Wasapi" Version="2.0.0" />
    <PackageReference Include="Vortice.D3DCompiler" Version="2.1.0-beta8" />
    <PackageReference Include="Vortice.Direct3D11" Version="2.1.0-beta8" />
    <PackageReference Include="Vortice.Mathematics" Version="1.3.22" />
  </ItemGroup>
  
  <ItemGroup>
	<Import Include="System" />
    <Import Include="System.Drawing" />
    <Import Include="System.Net.Http" />
    <Import Include="System.Numerics" />
    <Import Include="System.Windows" />
    <Import Include="System.Windows.Forms" />
    <Import Include="System.Xaml" />
    <Import Include="System.Xml.Linq" />
    <Import Include="Microsoft.CSharp" />
    <Import Include="System.Xml" />
    <Import Include="WindowsBase" />
    <Import Include="WindowsFormsIntegration" />
  </ItemGroup>
  
  <ItemGroup>
    <None Include="..\.editorconfig" Link=".editorconfig" />
    <None Include="..\Images\Flyleaf.png">
      <Pack>True</Pack>
      <PackagePath></PackagePath>
    </None>
  </ItemGroup>

</Project>
