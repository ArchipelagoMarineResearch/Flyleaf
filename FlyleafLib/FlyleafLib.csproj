<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>net6.0-windows;net5.0-windows;net472</TargetFrameworks>
	<UseWindowsForms>true</UseWindowsForms>
	<UseWPF>true</UseWPF>
	<PackageIcon>Flyleaf.png</PackageIcon>
	<PackageIconUrl />
	<RepositoryUrl></RepositoryUrl>
	<Description>Media Player .NET Library for WPF/WinForms (based on FFmpeg/DirectX)</Description>
	<Version>3.5-pre</Version>
	<Authors>SuRGeoNix</Authors>
	<Copyright>SuRGeoNix Â© 2022</Copyright>
	<PackageLicenseExpression>LGPL-3.0-or-later</PackageLicenseExpression>
	<PackageProjectUrl>https://github.com/SuRGeoNix/Flyleaf</PackageProjectUrl>
	<PackageTags>flyleaf flyleaflib video audio media player engine framework download extract ffmpeg vortice directx</PackageTags>
	<IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>
    <PackageReleaseNotes>
		[New Features]
		* Playlist
		- Adds Playlist support on the decoder context (will be extended to support playlist files such as .pls/.m3u/.m3u8 etc.)
		- Adds Playlist support for BitSwarm (Torrent) and YoutubeDL (Web) plugins
		- Allows playing received items while playlist is still in progress
		- Separates main user input with playlist items, embedded streams and external streams
		- Adds basic scraping (for title, season, episode)
		* Sessions: Adds support to re-open a previously opened session (with the same input/playlist item/streams/curtime/audio and subs delay)
		* Subtitles
		- Adds basic local search support and improves suggestion algorithm
		- Adds Config.Subtitles.SearchLocal/SearchLocalOnInputType/SearchOnline/SearchOnlineOnInputType

		[Enchantments]
		* Overall Code Clean-up
		* Renderer
		- Allows late assignment of the Control/Handle (you can start playing before the control has been created)
		- Allows WARP device to be forced from the configuration (luid=-1000)
		* Threading, Locking and Cancellation
		- Improves Open/OpenAsync implementation
		- Replaces threads with tasks and gets rid of EnsureThreadDone
		- Improves locking and cancellation
		* Demuxer Packet Queue, CurTime and BufferedDuration
		* UI Updates mainly for Streams (as ObservableCollection)

		[Issues]
		* Fixes a null reference on renderer's SetViewport with D3D11 VP #158
		* Fixes a rare dead lock on player's seek
		* Fixes an issue on WPF Control that it wouldn't go idle when the mouse was above the sliders

		[Important/Breaking Changes]
		* Player.Title can now be accessed from Player.Playlist.Selected.Title
		* Player.PlaybackCompleted renamed to Player.PlaybackStopped
		* Player.[AVS].Inputs and Player.[AVS].ExternalStreams can be accessed from Playlist.Items and Playlist.Items[N].External[AVS]Streams
		* LogOutput for files now will not append by default check Engine.Config.LogAppend
		* Changes the way that Player's Open Completed events will fire (only what user requested to open). If you still need to catch all the events subscribe on the Decoder Context's events (Player.decoder)
	</PackageReleaseNotes>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <DocumentationFile>FlyleafLib.xml</DocumentationFile>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>

  <ItemGroup>
    <None Remove="MediaFramework\MediaRenderer\Shaders\FlyleafPS.hlsl" />
    <None Remove="MediaFramework\MediaRenderer\Shaders\PSSimple.hlsl" />
    <None Remove="MediaFramework\MediaRenderer\Shaders\VSSimple.hlsl" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Include="MediaFramework\MediaRenderer\Shaders\FlyleafPS.hlsl" />
    <EmbeddedResource Include="MediaFramework\MediaRenderer\Shaders\PSSimple.hlsl" />
    <EmbeddedResource Include="MediaFramework\MediaRenderer\Shaders\VSSimple.hlsl" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="FFmpeg.AutoGen" Version="4.4.1.1" />
    <PackageReference Include="Vortice.D3DCompiler" Version="2.1.10-beta" />
    <PackageReference Include="Vortice.Direct3D11" Version="2.1.10-beta" />
    <PackageReference Include="Vortice.Mathematics" Version="1.4.13" />
    <PackageReference Include="Vortice.MediaFoundation" Version="2.1.10-beta" />
    <PackageReference Include="Vortice.XAudio2" Version="2.1.10-beta" />
  </ItemGroup>
  
  <ItemGroup>
	<Import Include="System" />
    <Import Include="System.Drawing" />
    <Import Include="System.Net.Http" />
    <Import Include="System.Numerics" />
    <Import Include="System.Windows" />
    <Import Include="System.Windows.Forms" />
    <Import Include="System.Xaml" />
    <Import Include="System.Xml.Linq" />
    <Import Include="Microsoft.CSharp" />
    <Import Include="System.Xml" />
    <Import Include="WindowsBase" />
    <Import Include="WindowsFormsIntegration" />
  </ItemGroup>
  
  <ItemGroup>
    <None Include="..\.editorconfig" Link=".editorconfig" />
    <None Include="..\Images\Flyleaf.png">
      <Pack>True</Pack>
      <PackagePath></PackagePath>
    </None>
  </ItemGroup>

</Project>
